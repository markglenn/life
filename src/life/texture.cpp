#include <life/texture.h>
#include <life/sdl_istream_adapter.h>
#include <SDL_image.h>

using std::ios;

namespace life
{
    ///////////////////////////////////////////////////////////////////////////
    texture::texture( std::string path, std::shared_ptr<life::archive> archive )
        : resource{ std::move( path ), std::move( archive ) }
    ///////////////////////////////////////////////////////////////////////////
    {
    }

    ///////////////////////////////////////////////////////////////////////////
    texture::~texture( )
    ///////////////////////////////////////////////////////////////////////////
    {
    }

    ///////////////////////////////////////////////////////////////////////////
    bool texture::load( )
    ///////////////////////////////////////////////////////////////////////////
    {
        auto stream = archive( )->open( path( ), ios::in | ios::binary );
        auto surface = IMG_Load_RW( SDL_RW_from_istream( *stream ), 1 );

        if( !surface )
            return false;

        SDL_FreeSurface( surface );

        return true;
    }

    ///////////////////////////////////////////////////////////////////////////
    bool texture::unload( )
    ///////////////////////////////////////////////////////////////////////////
    {
        return true;
    }
}
